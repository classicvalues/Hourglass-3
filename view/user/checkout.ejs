<%- include('partials/header.ejs') %>

<!--================Home Banner Area =================-->
<!-- breadcrumb start-->
<!-- <section class="breadcrumb breadcrumb_bg">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-8">
          <div class="breadcrumb_iner">
            <div class="breadcrumb_iner_item">
              <h2>Product Checkout</h2>
              <p>Home <span>-</span> Product Checkout</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section> -->
<!-- breadcrumb start-->

<!--================Checkout Area =================-->
<section class="checkout_area padding_top">
  <div class="container">
    <!-- <div class="returning_customer">
        <div class="check_title">
          <h2>
            Returning Customer?
            <a href="#">Click here to login</a>
          </h2>
        </div>
        <p>
          If you have shopped with us before, please enter your details in the
          boxes below. If you are a new customer, please proceed to the
          Billing & Shipping section.
        </p>
        <form class="row contact_form" action="#" method="post" novalidate="novalidate">
          <div class="col-md-6 form-group p_star">
            <input type="text" class="form-control" id="name" name="name" value=" " />
            <span class="placeholder" data-placeholder="Username or Email"></span>
          </div>
          <div class="col-md-6 form-group p_star">
            <input type="password" class="form-control" id="password" name="password" value="" />
            <span class="placeholder" data-placeholder="Password"></span>
          </div>
          <div class="col-md-12 form-group">
            <button type="submit" value="submit" class="btn_3">
              log in
            </button>
            <div class="creat_account">
              <input type="checkbox" id="f-option" name="selector" />
              <label for="f-option">Remember me</label>
            </div>
            <a class="lost_pass" href="#">Lost your password?</a>
          </div>
        </form>
      </div> -->

    <div class="billing_details">
      <form name="checkoutForm" action="/checkout" onsubmit="return validate()" method="post">
        <div class="row">
          <div class="col-lg-8">
            <h3>Shipping Address</h3>
            <!-- <div class="col-md-6 form-group p_star">
              <input type="text" class="form-control" id="first" name="name" />
              <span class="placeholder" data-placeholder="First name"></span>
            </div>
            <div class="col-md-6 form-group p_star">
              <input type="text" class="form-control" id="last" name="name" />
              <span class="placeholder" data-placeholder="Last name"></span>
            </div>
            <div class="col-md-12 form-group">
              <input type="text" class="form-control" id="company" name="company" placeholder="Company name" />
            </div>
            <div class="col-md-6 form-group p_star">
              <input type="text" class="form-control" id="number" name="number" />
              <span class="placeholder" data-placeholder="Phone number"></span>
            </div>
            <div class="col-md-6 form-group p_star">
              <input type="text" class="form-control" id="email" name="compemailany" />
              <span class="placeholder" data-placeholder="Email Address"></span>
            </div>
            <div class="col-md-12 form-group p_star">
              <select class="country_select">
                <option value="1">Country</option>
                <option value="2">Country</option>
                <option value="4">Country</option>
              </select>
            </div>
            <div class="col-md-12 form-group p_star">
              <input type="text" class="form-control" id="add1" name="add1" />
              <span class="placeholder" data-placeholder="Address line 01"></span>
            </div>
            <div class="col-md-12 form-group p_star">
              <input type="text" class="form-control" id="add2" name="add2" />
              <span class="placeholder" data-placeholder="Address line 02"></span>
            </div>
            <div class="col-md-12 form-group p_star">
              <input type="text" class="form-control" id="city" name="city" />
              <span class="placeholder" data-placeholder="Town/City"></span>
            </div>
            <div class="col-md-12 form-group p_star">
              <select class="country_select">
                <option value="1">District</option>
                <option value="2">District</option>
                <option value="4">District</option>
              </select>
            </div>
            <div class="col-md-12 form-group">
              <input type="text" class="form-control" id="zip" name="zip" placeholder="Postcode/ZIP" />
            </div>
            <div class="col-md-12 form-group">
              <div class="creat_account">
                <input type="checkbox" id="f-option2" name="selector" />
                <label for="f-option2">Create an account?</label>
              </div>
            </div> -->
            <div class="panel-group" id="accordion">
              <% for( let i = 0; i < address.length; i++ ) { %>
              <div class="panel panel-default order_box">
                <div class="panel-heading">
                  <h4 class="panel-title">
                    <label for="r<%= i %>">
                      <input type="radio" id="r<%= i %>" name="address" value="<%= address[i]._id %>" />
                      <%= address[i].house %>
                      <a data-toggle="collapse" data-parent="#accordion" href="#collapse<%= i %>"></a>
                    </label>
                  </h4>
                </div>
                <div id="collapse<%= i %>" class="panel-collapse collapse">
                  <div class="panel-body">
                    <ul class="list-unstyled mt-3 mb-4">
                      <li><%= address[i].landmark %></li>
                      <li><%= address[i].city %></li>
                      <li><%= address[i].district %></li>
                      <li><%= address[i].state %></li>
                      <li><%= address[i].pincode %></li>
                      <li><%= address[i].mob %></li>
                    </ul>
                  </div>
                </div>
              </div>

              <% } %>
            </div>
            <a class="btn_3 mt-3" href="#">Add Address</a>
         <!-- Coupon Details entering area  -->
         <div class="card mt-4" style="width: 18rem; padding: 1rempx">
          <div class="card-body">
            <div class="card-title">Have a coupon?</div>
            <input type="text" class="mt-3" placeholder="Enter coupon code" />
            <a class="btn_3 mt-3" href="#">Apply Coupon</a>
          </div>
        </div>
            <!-- Shipping details -->
            <!-- <div class="col-md-12 form-group">
              <div class="creat_account">
                <h3>Shipping Details</h3>
                <input type="checkbox" id="f-option3" name="selector" />
                <label for="f-option3">Ship to a different address?</label>
              </div>
              <textarea class="form-control" name="message" id="message" rows="1" placeholder="Order Notes"></textarea>
            </div> -->
          </div>
          <div class="col-lg-4">
   
            <div class="order_box mt-3">
              <h2>Your Order</h2>
              <ul class="list">
                <% products.forEach(el => { %>

                <li>
                  <a href="/" aria-hidden="true"
                    ><%= el.product.title %>
                    <span class="middle">x <%= el.quantity %> </span>
                    <span class="last">₹<%= el.subtotal %>.00</span>
                  </a>
                </li>

                <% }) %>
              </ul>
              <ul class="list list_2">
                <li>
                  <a href="#"
                    >Subtotal
                    <span>₹<%= total %>.00</span>
                  </a>
                </li>
                <li>
                  <a href="#"
                    >Shipping
                    <span>Flat rate: ₹50.00</span>
                  </a>
                </li>
                <li>
                  <a href="#"
                    >Total
                    <span>₹<%= total+50 %>.00</span>
                  </a>
                </li>
              </ul>
              
            <div class="creat_account">
              <input type="checkbox" id="f-option4" name="tnc" />
              <label for="f-option4">I’ve read and accept the </label>
              <a href="#">terms & conditions*</a>
            </div>
              <!-- <div class="payment_item">
              <div class="radion_btn">
                <input type="radio" id="f-option5" name="selector" />
                <label for="f-option5">Check payments</label>
                <div class="check"></div>
              </div>
              <p>Please send a check to Store Name, Store Street, Store Town, Store State / County, Store Postcode.</p>
            </div>
            <div class="payment_item active">
              <div class="radion_btn">
                <input type="radio" id="f-option6" name="selector" />
                <label for="f-option6">Paypal </label>
                <img src="img/product/single-product/card.jpg" alt="" />
                <div class="check"></div>
              </div>
              <p>Please send a check to Store Name, Store Street, Store Town, Store State / County, Store Postcode.</p>
            </div> -->

              <!-- <div class="payment_item active">
                <div class="radion_btn">
                  <input type="radio" id="f-option6" name="payment" value="cod" />
                  <label for="f-option6">COD </label>
                  <img src="img/product/single-product/card.jpg" alt="" />
                  <div class="check"></div>
                </div>
                <p>
                  Please fill in the adddress to Deliver Ensure you filled Name, Store Street, Store Town, Store State /
                  County, Store Postcode.
                </p>
              </div>
              <div class="creat_account">
                <input type="checkbox" id="f-option4" name="tnc" />
                <label for="f-option4">I’ve read and accept the </label>
                <a href="#">terms & conditions*</a>
              </div> -->
              <button type="submit" class="btn_3 mt-4 mx-auto">Proceed to Payment</button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</section>
<!--================End Checkout Area =================-->

<script>
  for (let i = 0; i < Number('<%= address.length %>'); i++) {
    $(`#r${i}`).on('click', function () {
      $(this).parent().find('a').trigger('click');
    });
  }

  // $('#r12').on('click', function(){
  //   $(this).parent().find('a').trigger('click')
  // })
  function validate() {
    if (document.querySelector('input[name="address"]:checked') == null) {
      customAlert('Please select a shipping address.')
      return false;
    }
    
    if (!document.checkoutForm.tnc.checked) {
      customAlert('Please accept terms and conditions.')
      return false;
    }

    return true;
  }
  function customAlert(message) {
    Swal.fire(message)
  }
</script>

<%- include('partials/footer.ejs') %>
